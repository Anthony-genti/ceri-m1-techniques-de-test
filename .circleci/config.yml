deploy:
  docker:
    - image: node:16.3.0
  steps:
    - checkout
    - attach_workspace:
        at: /workspace
    - run:
        name: Install gh-pages
        command: npm install -g gh-pages
    - run:
        name: Verify Javadoc Directory
        command: |
          if [ ! -d "/workspace/ceri-m1-techniques-de-test/target/site/apidocs" ]; then
            echo "Javadoc directory does not exist"
            exit 1
    - run:
        name: Configure Git
        command: |
          git config --global user.email "anthony.genti@alumni.univ-avignon.fr"
          git config --global user.name "Anthony-genti"
    - run:
        name: Deploy Javadoc to gh-pages
        command: |
          touch /workspace/ceri-m1-techniques-de-test/target/site/apidocs/.nojekyll
          gh-pages --dotfiles --message "[skip ci] Updates" --dist "/workspace/ceri-m1-techniques-de-test/target/site/apidocs"